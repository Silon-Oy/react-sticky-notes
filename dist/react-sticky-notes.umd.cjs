(function(b,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react/jsx-runtime"),require("react")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react"],c):(b=typeof globalThis<"u"?globalThis:b||self,c(b.ReactStickyNotes={},b.jsxRuntime,b.React))})(this,(function(b,c,o){"use strict";const w=[{name:"yellow",bg:"#fef9c3",border:"#facc15",text:"#713f12"},{name:"pink",bg:"#fce7f3",border:"#f472b6",text:"#831843"},{name:"blue",bg:"#dbeafe",border:"#60a5fa",text:"#1e3a5f"},{name:"green",bg:"#dcfce7",border:"#4ade80",text:"#14532d"},{name:"orange",bg:"#ffedd5",border:"#fb923c",text:"#7c2d12"},{name:"purple",bg:"#f3e8ff",border:"#c084fc",text:"#581c87"}];function I(t){try{const n=localStorage.getItem(t);return n?JSON.parse(n):[]}catch{return[]}}function z(t,n){try{localStorage.setItem(t,JSON.stringify(n))}catch{}}async function S(t,n,f){const r=await fetch(t,{...n,headers:{"Content-Type":"application/json","X-API-Key":f,...n&&n.headers}});if(!r.ok)throw new Error(`API ${r.status}`);return r.json()}function E(t="react-sticky-notes",n=null,f=null){const r=!!n,y=`sticky-notes:${t}`,[d,m]=o.useState(()=>r?[]:I(y)),s=o.useRef(new Set),x=o.useRef({});o.useEffect(()=>{r||z(y,d)},[r,y,d]),o.useEffect(()=>{if(!r)return;let a=!0;const g=async()=>{try{const e=await S(n,{},f);if(!a)return;m(l=>{const k=e.map(u=>s.current.has(u.id)&&l.find(C=>C.id===u.id)||u);for(const u of l)s.current.has(u.id)&&!e.find(C=>C.id===u.id)&&k.push(u);return k})}catch{}};g();const h=setInterval(g,3e3);return()=>{a=!1,clearInterval(h)}},[r,n,f]);const p=o.useCallback((a,g)=>{const h={id:`n-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,x:a,y:g,text:"",colorIndex:0,minimized:!1,createdAt:Date.now()};return m(e=>[...e,h]),r&&(s.current.add(h.id),S(n,{method:"POST",body:JSON.stringify(h)},f).catch(()=>{}).finally(()=>s.current.delete(h.id))),h},[r,n,f]),i=o.useCallback((a,g)=>{m(h=>h.map(e=>e.id===a?{...e,...g}:e)),r&&(s.current.add(a),clearTimeout(x.current[a]),x.current[a]=setTimeout(()=>{S(`${n}/${a}`,{method:"PUT",body:JSON.stringify(g)},f).catch(()=>{}).finally(()=>s.current.delete(a))},150))},[r,n,f]),v=o.useCallback(a=>{m(g=>g.filter(h=>h.id!==a)),r&&(s.current.add(a),S(`${n}/${a}`,{method:"DELETE"},f).catch(()=>{}).finally(()=>s.current.delete(a)))},[r,n,f]);return{notes:d,addNote:p,updateNote:i,deleteNote:v}}const T=`@keyframes stickyNotePulse {
  0%, 100% { transform: scale(1); opacity: 0.85; }
  50% { transform: scale(1.18); opacity: 1; }
}`;let N=!1;function D(){if(N)return;const t=document.createElement("style");t.textContent=T,document.head.appendChild(t),N=!0}function L({note:t,onUpdate:n,onDelete:f}){const r=w[t.colorIndex%w.length],y=o.useRef(null),[d,m]=o.useState(!1),s=o.useRef(!1),x=o.useRef({x:0,y:0});o.useEffect(()=>{D()},[]),o.useEffect(()=>{!t.minimized&&y.current&&requestAnimationFrame(()=>{var l;const e=(l=y.current)==null?void 0:l.querySelector("textarea");e&&e.focus()})},[t.minimized]);const p=o.useCallback((e,l)=>{x.current={x:e-t.x,y:l-t.y},s.current=!1,m(!0)},[t.x,t.y]),i=o.useCallback((e,l)=>{d&&(s.current=!0,n(t.id,{x:e-x.current.x,y:l-x.current.y}))},[d,t.id,n]),v=o.useCallback(()=>{m(!1)},[]);o.useEffect(()=>{if(!d)return;const e=u=>i(u.clientX,u.clientY),l=u=>{u.preventDefault(),i(u.touches[0].clientX,u.touches[0].clientY)},k=()=>v();return window.addEventListener("mousemove",e),window.addEventListener("mouseup",k),window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",k),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",k),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",k)}},[d,i,v]);const a=()=>{n(t.id,{colorIndex:(t.colorIndex+1)%w.length})},g=()=>{window.confirm("Delete this note?")&&f(t.id)},h=o.useCallback(e=>{e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||d||n(t.id,{minimized:!0})},[t.id,n,d]);return t.minimized?c.jsx("div",{onMouseDown:e=>{e.preventDefault(),p(e.clientX,e.clientY)},onTouchStart:e=>{p(e.touches[0].clientX,e.touches[0].clientY)},onClick:()=>{s.current||n(t.id,{minimized:!1})},style:{position:"fixed",left:t.x,top:t.y,width:18,height:18,borderRadius:"50%",backgroundColor:r.border,cursor:d?"grabbing":"pointer",zIndex:1e4,boxShadow:"0 1px 4px rgba(0,0,0,0.2)",animation:d?"none":"stickyNotePulse 2.5s ease-in-out infinite"},title:"Click to expand"}):c.jsxs("div",{ref:y,tabIndex:-1,onBlur:h,style:{position:"fixed",left:t.x,top:t.y,width:220,backgroundColor:r.bg,border:`1.5px solid ${r.border}`,borderRadius:8,boxShadow:d?"0 8px 24px rgba(0,0,0,0.18)":"0 2px 8px rgba(0,0,0,0.12)",zIndex:d?10002:10001,fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",fontSize:13,userSelect:d?"none":"auto",transition:d?"none":"box-shadow 0.2s",outline:"none"},children:[c.jsxs("div",{onMouseDown:e=>{e.preventDefault(),p(e.clientX,e.clientY)},onTouchStart:e=>{p(e.touches[0].clientX,e.touches[0].clientY)},style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 8px",cursor:"grab",borderBottom:`1px solid ${r.border}`,borderRadius:"8px 8px 0 0",backgroundColor:r.border+"33"},children:[c.jsx("div",{style:{width:30,height:4,borderRadius:2,backgroundColor:r.border,opacity:.5}}),c.jsxs("div",{style:{display:"flex",gap:4},children:[c.jsx("button",{onClick:a,style:{width:18,height:18,borderRadius:"50%",border:`1.5px solid ${r.text}44`,background:`conic-gradient(${w.map((e,l)=>`${e.border} ${l/w.length*100}% ${(l+1)/w.length*100}%`).join(", ")})`,cursor:"pointer",padding:0},title:"Change color"}),c.jsx("button",{onClick:()=>n(t.id,{minimized:!0}),style:{width:18,height:18,borderRadius:"50%",border:"none",background:r.text+"22",color:r.text,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,lineHeight:1,padding:0},title:"Minimize",children:"−"}),c.jsx("button",{onClick:g,style:{width:18,height:18,borderRadius:"50%",border:"none",background:"#ef444433",color:"#dc2626",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,lineHeight:1,padding:0},title:"Delete",children:"×"})]})]}),c.jsx("textarea",{value:t.text,onChange:e=>n(t.id,{text:e.target.value}),placeholder:"Write a note...",style:{width:"100%",minHeight:80,padding:"8px 10px",border:"none",background:"transparent",color:r.text,fontSize:13,fontFamily:"inherit",resize:"vertical",outline:"none",boxSizing:"border-box"}})]})}function $({storageKey:t="react-sticky-notes",apiUrl:n=null,apiKey:f=null}){const{notes:r,addNote:y,updateNote:d,deleteNote:m}=E(t,n,f),[s,x]=o.useState(!1),p=o.useCallback(i=>{i.target.closest("[data-sticky-fab]")||i.target.closest("[data-sticky-note]")||(y(i.clientX-110,i.clientY-20),x(!1))},[y]);return o.useEffect(()=>{if(!s)return;const i=v=>{v.key==="Escape"&&x(!1)};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[s]),c.jsxs(c.Fragment,{children:[s&&c.jsx("div",{onClick:p,style:{position:"fixed",inset:0,cursor:"crosshair",zIndex:9998,backgroundColor:"rgba(0,0,0,0.05)"}}),r.map(i=>c.jsx("div",{"data-sticky-note":!0,children:c.jsx(L,{note:i,onUpdate:d,onDelete:m})},i.id)),c.jsx("button",{"data-sticky-fab":!0,onClick:()=>x(i=>!i),style:{position:"fixed",bottom:24,right:24,width:48,height:48,borderRadius:"50%",border:"none",backgroundColor:s?"#ef4444":"#fbbf24",color:s?"#fff":"#713f12",fontSize:24,fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 10px rgba(0,0,0,0.2)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,transition:"all 0.2s",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"},onMouseEnter:i=>{i.currentTarget.style.transform="scale(1.1)"},onMouseLeave:i=>{i.currentTarget.style.transform="scale(1)"},title:s?"Cancel (Esc)":"Add sticky note",children:s?"×":"+"})]})}b.COLORS=w,b.StickyNotes=$,b.useNotes=E,Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})}));
